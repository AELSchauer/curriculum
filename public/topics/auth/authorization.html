
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Authorization with CanCan - Jumpstart Lab Curriculum</title>
  <meta name="author" content="Jumpstart Lab">

  
  <meta name="description" content="Authentication & Authorization                                      Authorization with CanCan &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://tutorials.jumpstartlab.com/topics/auth/authorization.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection, print" rel="stylesheet" type="text/css">

  <link href="/atom.xml" rel="alternate" title="Jumpstart Lab Curriculum" type="application/atom+xml">

  <!-- TAB SLIDE OUT -->
  <script src="/javascripts/jquery-1.3.2.min.js" type="text/javascript"></script>
  <script src="/javascripts/jquery.tabSlideOut.v1.3.js"></script>

  <!-- SEARCH -->
  <script src="/search.js"></script>

  <script type="text/javascript">
    $(function(){
      $('.slide-out-div').tabSlideOut({
        tabHandle: '.handle',                     //class of the element that will become your tab
        pathToTabImage: '/images/feedback_tabv2.png', //path to the image for the tab //Optionally can be set using css
        imageHeight: '130px',                     //height of tab image           //Optionally can be set using css
        imageWidth: '36px',                       //width of tab image            //Optionally can be set using css
        tabLocation: 'left',                      //side of screen where tab lives, top, right, bottom, or left
        speed: 300,                               //speed of animation
        action: 'click',                          //options: 'click' or 'hover', action to trigger animation
        topPos: '200px',                          //position from the top/ use if tabLocation is left or right
        leftPos: '20px',                          //position from left/ use if tabLocation is bottom or top
        fixedPosition: true                      //options: true makes it stick(fixed position) on scroll
        });
      });
  </script>

  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

</head>

<body  >
  <header role="banner">
    <hgroup>
  <h1>Jumpstart Lab Curriculum</h1>
  
</hgroup>

  </header>

  <nav role="navigation">
    <ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:tutorials.jumpstartlab.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>

<ul class="main-navigation">
  <li><a href="/">Curriculum Index</a></li>
  <li><div id="search">
  <form>
    <input type="text" id="st-search-input" class="st-search-input" />
  </form>
</div>
</li>
</ul>
  </nav>

  <div id="main">
    <div id="content">
      <div>
  <article role="article">
    
      
        <p class="section-title">Authentication & Authorization</p>
      
    
    
      <header>
        <h1 class="entry-title">
          Authorization with CanCan
        </h1>
        
      </header>
    
    <h2>Learning Goals</h2>

<p>After this tutorial you should be able to:</p>

<ul>
<li>Explain how authorization differs from authentication</li>
<li>Use CanCan to implement authorization helpers in a Rails application</li>
</ul>

<h2>Getting Started</h2>

<p>Authorization is an important aspect to most any application. As a system, it is put in place to determine whether the current user has the permission to perform the requested action. Based on this, it typically happens after a user is authenticated, but before a request is processed.</p>

<p>The important question to ask is, <em>is the user allowed to do what they&#8217;re trying to do</em>?</p>

<h3>Library Choices</h3>

<p>When implementing an authorization system in Rails, there a few choices to consider.</p>

<p>The first, <a href="https://github.com/stffn/declarative_authorization">Declarative Authorization</a> has been around since 2008. It introduced the idea of a centralized permissions file and a clean DSL for referring to those permissions. Its last
update was in March 2013, so the project is stalled and probably isn&#8217;t the right choice.</p>

<p>Later, <a href="https://github.com/ryanb/cancan">CanCan</a>, was inspired by DeclarativeAuthorization and created by Ryan Bates of Railscasts. It provides an intuitive interface to define your authorization rules and integrates into Rails seamlessly.
The tutorial below will use CanCan as it is the most popular choice, but it too has stalled out in the last year.
The community has forked the project to continue merging pull requests and improving the library, now
known as <a href="https://github.com/cancancommunity/cancancan">CanCanCan</a></p>

<p>The newcomer is <a href="https://github.com/elabs/pundit">Pundit</a> from our friends at elabs,
the same bunch that put together Capybara. It&#8217;s worth checking out.</p>

<h3>Setup</h3>

<p>Let&#8217;s try out CanCanCan. To get started, add <code>cancancan</code> to the <code>Gemfile</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="s1">&#39;cancancan&#39;</span><span class="p">,</span> <span class="s1">&#39;~&gt; 1.9&#39;</span>
</span></code></pre></td></tr></table></div></figure>

<p>Then run <code>bundle</code> from the command line.</p>

<h3>The Current User</h3>

<p>It is conventional to implement a helper method named <code>current_user</code> in your controllers. It should return an instance of the <code>User</code> model that is currently active in the session.</p>

<p><code>CanCan</code> is expecting <code>current_user</code> to be available for its controller includes to work, which are setup automatically in descendants of <code>ActionController::Base</code> once the <code>CanCan</code> gem is required.</p>

<h2>Creating Abilities</h2>

<p>To define an application&#8217;s authorization rules, we&#8217;ll think in terms of abilities. For example, is the <code>current_user</code> able to update their own information?</p>

<h3>Generate the Ability File</h3>

<p>As of version 1.5, <code>CanCan</code> includes a generator to create our <code>Ability</code> file for Rails 3 applications. It is placed in the <code>app/models</code> directory and is where all of your ability definitions will live. To execute the generator, run the following from the command line:</p>

<div class="window">
          <nav class="control-window">
            <a href="#finder" class="close" data-rel="close">close</a>
            <a href="#" class="minimize">minimize</a>
            <a href="#" class="deactivate">deactivate</a>
          </nav>
          <h1 class="titleInside">Terminal</h1>
          <div class="container"><div class="terminal"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>$</span>
</pre></td><td class='code'><pre><code><span class='line command'>rails generate cancan:ability</span></code></pre></td></tr></table></div></div>
        </div>

<h3>Defining Abilities</h3>

<p><code>CanCan</code> provides a succinct DSL for defining abilities. Let&#8217;s dive in and look at a simple example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># app/models/ability.rb</span>
</span><span class='line'><span class="k">class</span> <span class="nc">Ability</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Add in CanCan&#39;s ability definition DSL</span>
</span><span class='line'>  <span class="kp">include</span> <span class="no">CanCan</span><span class="o">::</span><span class="no">Ability</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span> <span class="n">user</span> <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1"># Handle the case where we don&#39;t have a current_user i.e. the user is a guest</span>
</span><span class='line'>    <span class="n">user</span> <span class="o">||=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1"># Define a few sample abilities</span>
</span><span class='line'>    <span class="n">can</span>    <span class="ss">:manage</span> <span class="p">,</span> <span class="no">Article</span>
</span><span class='line'>    <span class="n">cannot</span> <span class="ss">:manage</span> <span class="p">,</span> <span class="no">Comment</span>
</span><span class='line'>    <span class="n">can</span>    <span class="ss">:read</span>   <span class="p">,</span> <span class="no">Tag</span> <span class="p">,</span> <span class="n">released</span><span class="p">:</span> <span class="kp">true</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>

<p>The <code>CanCan</code> generator will provide the structure for your Ability class. At a basic level then, all you need to do is implement the constructor. Here we can see a few things&#8230;</p>

<ul>
<li>As is recommended in the <code>CanCan</code> documentation, the case where a <code>current_user</code> is <code>nil</code> is handled.</li>
<li>A user can perform all actions (<code>:manage</code>) the <code>Article</code> model</li>
<li>Users cannot perform any actions on the <code>Comment</code> model.</li>
<li>Users can read instances of the <code>Tag</code> model where <code>baz.released</code> is <code>true</code></li>
</ul>

<h3>Building Roles</h3>

<p>By default, <code>CanCan</code> does not make any assumptions about whether you will need roles in your application and what they might be. At their most basic, we could implement administrators and non-administrators.</p>

<p>To begin implementing roles, let&#8217;s consider a simple <code>User</code> model.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># app/models/user.rb</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>  <span class="n">attr_accessible</span> <span class="ss">:name</span> <span class="p">,</span> <span class="ss">:email</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># User::Roles</span>
</span><span class='line'>  <span class="c1"># The available roles</span>
</span><span class='line'>  <span class="no">Roles</span> <span class="o">=</span> <span class="o">[</span> <span class="ss">:admin</span> <span class="p">,</span> <span class="ss">:default</span> <span class="o">]</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">is?</span><span class="p">(</span> <span class="n">requested_role</span> <span class="p">)</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">role</span> <span class="o">==</span> <span class="n">requested_role</span><span class="o">.</span><span class="n">to_s</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>

<p>As you can see, the <code>User::Roles</code> array lists the different roles that a <code>User</code> might be. Since we want to persist a user&#8217;s role, we would add a <code>String</code> field called <code>role</code> to the <code>User</code> model via a database migration.</p>

<h3>Admin Abilities</h3>

<p>Now, to define the abilities of an <code>:admin</code>, we should revisit the previously created <code>Ability</code> class.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># app/models/ability.rb</span>
</span><span class='line'><span class="k">class</span> <span class="nc">Ability</span>
</span><span class='line'>  <span class="kp">include</span> <span class="no">CanCan</span><span class="o">::</span><span class="no">Ability</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span> <span class="n">user</span> <span class="p">)</span>
</span><span class='line'>    <span class="n">user</span> <span class="o">||=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1"># Define User abilities</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">is?</span> <span class="ss">:admin</span>
</span><span class='line'>      <span class="n">can</span> <span class="ss">:manage</span><span class="p">,</span> <span class="no">Article</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="n">can</span> <span class="ss">:read</span><span class="p">,</span> <span class="no">Article</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>

<p>If a user is an <code>:admin</code>, they&#8217;re allowed to manage any <code>Article</code>. Otherwise, users can only read articles. By using the simple <code>User#is?</code> method, we can expressively determine the role of a user.</p>

<p>See the <code>CanCan</code> wiki for more information on <a href="https://github.com/ryanb/cancan/wiki/Defining-Abilities">Defining Abilities</a> and <a href="https://github.com/ryanb/cancan/wiki/Role-Based-Authorization">Role Based Authorization</a>.</p>

<h2>Checking Abilities</h2>

<p>Once your application&#8217;s abilities are defined, they can be checked throughout the app.</p>

<h3>Can?</h3>

<p>The <code>can?</code> check uses your ability definitions to determine whether a user action is allowed.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='erb'><span class='line'><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">&quot;New User&quot;</span> <span class="p">,</span> <span class="n">new_user_path</span> <span class="k">if</span> <span class="n">can?</span> <span class="ss">:create</span><span class="p">,</span> <span class="no">User</span> <span class="cp">%&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure>

<h4>Cannot?</h4>

<p>Alternatively, the <code>cannot?</code> helper is available and checks whether a user action is NOT allowed.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='rhtml'><span class='line'><span class="cp">&lt;%</span> <span class="k">if</span> <span class="n">cannot?</span> <span class="ss">:destroy</span> <span class="p">,</span> <span class="vi">@user</span> <span class="cp">%&gt;</span>
</span><span class='line'>  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;permission-message&quot;</span><span class="nt">&gt;</span>You aren&#39;t allowed to delete this user.<span class="nt">&lt;/span&gt;</span>
</span><span class='line'><span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</span></code></pre></td></tr></table></div></figure>

<h3>Load and Authorize Resource</h3>

<p><code>CanCan</code> provides numerous helpers for use at the controller level. One that is particularly useful is <code>load_and_authorize_resource</code>. Calling this at a class level in a controller will automatically load the model and authorize the requested action.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># app/controllers/users_controller.rb</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>  <span class="n">load_and_authorize_resource</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>

<h3>Handling Authorization Failure</h3>

<p>When using <code>load_and_authorize_resource</code> manually, an authorization failure will raise a exception. The way to handle these exceptions is by writing a <code>rescue_from</code> block in your base controller.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># app/controllers/application_controller.rb</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Catch all CanCan errors and alert the user of the exception</span>
</span><span class='line'>  <span class="n">rescue_from</span> <span class="no">CanCan</span><span class="o">::</span><span class="no">AccessDenied</span> <span class="k">do</span> <span class="o">|</span> <span class="n">exception</span> <span class="o">|</span>
</span><span class='line'>    <span class="n">redirect_to</span> <span class="n">root_url</span><span class="p">,</span> <span class="n">alert</span><span class="p">:</span> <span class="n">exception</span><span class="o">.</span><span class="n">message</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>

<p>The exception passed in to the <code>rescue_from</code> block will contain the data necessary to inform the user of the error.</p>

<h2>Usage Patterns</h2>

<h3>Dealing with Complexity</h3>

<p>As your application grows beyond a few models, ability definitions can
quickly become complex. At first, a solution such as the one described
in the last section of the <code>CanCan</code> <a href="https://github.com/ryanb/cancan/wiki/Role-Based-Authorization">Role Based
Authorization</a>
wiki page can be useful. Even then, the <code>ability.rb</code> file can grow
unruly at fast pace.</p>

<p>At a certain point, there are few options to keep ability definitions
under control:</p>

<ul>
<li>Roll your own solution to split ability definitions in to multiple files by role or model.</li>
<li>Use a <code>CanCan</code> extension gem such as <a href="https://github.com/kristianmandrup/cantango">cantango</a> or <a href="https://github.com/quickleft/role_up">role_up</a></li>
</ul>

<h3>Testing Abilities</h3>

<p>Writing tests against your ability definitions at the unit level, as
opposed to through functional or integration tests, can be a huge
benefit for your codebase. There are wonderful matchers available for
<code>RSpec</code> in <code>CanCan</code>. Check out the <a href="https://github.com/ryanb/cancan/wiki/Testing-Abilities">testing wiki
page</a> for code
examples.</p>

<h2>Exercises</h2>

<div class="note">
  <p>Use the Blogger sample application to complete the exercises in this section. See the <a href="/topics/sample_project.html">Setup Instructions</a> for help.</p>
</div>

<ol>
<li>Follow the instructions above to install CanCan and generate the abilities file.</li>
<li>Follow the previous Local Authentication tutorial to build authentication using Devise.</li>
<li>Define a <code>role</code> attribute in your users table. Create one admin and one non-admin user.</li>
<li>Define abilities such that the admin can manage an <code>Article</code> and a normal user can only read them (using <code>index</code> and <code>show</code>).</li>
<li>Add checks in the view templates to hide links when the user is not permitted to execute the associated action.</li>
<li>Use <code>load_and_authorize_resource</code> in the <code>ArticlesController</code> and remove any unnecessary code in the actions.</li>
</ol>

<h2>References</h2>

<ul>
<li><a href="https://github.com/ryanb/cancan/wiki">CanCan Wiki</a></li>
<li><a href="https://github.com/stffn/declarative_authorization">Declarative Authorization</a></li>
<li><a href="http://edgeguides.rubyonrails.org/security.html#countermeasures">Security Countermeasures Rails Guide</a></li>
</ul>

    
    
      <footer>
        
        
          <div class="sharing">
  
  
</div>

        
      </footer>
    
  </article>


</div>



    </div>

    <div class="footer">
  <p>
    All materials licensed <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution-NonCommercial-ShareAlike 3.0</a>&nbsp;
    <img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/80x15.png" />
  </p>
</div>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-42709122-1', 'jumpstartlab.com');
ga('send', 'pageview');
</script>
  </div>

  


  <div class="slide-out-div">
  <a class="handle" href="#">Feedback</a>
  <h3>Have Feedback?</h3>
  <p>Did you find an error? Something confusing? We'd love your help:</p>
  <ul>
    <li><a href="#" id="edit_source">Edit the source code of this page directly on GitHub</a></li>
    <li><a href="https://github.com/JumpstartLab/curriculum/issues">Create a new issue on the project's GitHub page</a></li>
  </ul>
  <p>Thanks!</p>
</div>

<script>
  $(function(){
    var pathname = window.location.pathname.replace( ".html", ".markdown" );
    var github_url = "https://github.com/JumpstartLab/curriculum/blob/master/source" + pathname;
    $("a#edit_source").attr('href', github_url);
  });
</script>

</body>
</html>
